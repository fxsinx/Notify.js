"use strict";!function(e){var n=arguments.length<=1||void 0===arguments[1]?"Notify":arguments[1];"function"==typeof define?define(e):"undefined"!=typeof module&&module.exports?module.exports=e():"undefined"!=typeof window&&(window[n]=e())}(function(){var e=function(){return 1*new Date+Math.random().toString(36).replace(/[^a-zA-Z0-9]+/g,"")},n=function(e){return e.replace(/(\/+$)/,"").replace(/\\/g,"/").replace(/^\/+/,"").replace(/\/{2,}/g,"/").replace(/\*{2,}/g,"*").trim()},t=function r(n,t){var i=arguments.length<=2||void 0===arguments[2]?e():arguments[2],o=r.getPath(n);this.expression=n,this.listener=t,this.id=i,o.items.push(this)};t.getPath=function(e){var n=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],r=t.notifies.find(function(n){return n.expression===e});return!r&&n&&(r={expression:e,items:[]},r.reg=new RegExp("^"+i(e,"|?.[]{}\\/^$()").replace(/\*/g,".+")),t.notifies.push(r)),r};var i=function(e,n){return[].forEach.call(n,function(n){e=e.replace(new RegExp("\\"+n,"g"),"\\"+n)}),e};return t.matchPathes=function(e){return e=n(e),t.notifies.filter(function(n){return n.reg.test(e)})},t.on=function(){var e=arguments.length<=0||void 0===arguments[0]?"*":arguments[0],n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1],i=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return new t(e,n.bind(i)).id},t.off=function(e){var n,i,r=!1;for(n=0;n<t.notifies.length;n++){var o=t.notifies[n];for(i=0;i<o.items.length;i++)if(o.items[i].id===e){o.items.splice(i,1),r=!0;break}if(r){o.items.length<1&&t.notifies.splice(n,1);break}}return r},t.trigger=function(e,i,r){var o=t.matchPathes(n(e));if(e.indexOf("*")>-1)throw"Expression should not contain *";var f={target:i,data:r,actualExpression:e};o.forEach(function(e){e.items.forEach(function(e){f.expression=e.expression,e.listener(f)})})},t.clearAll=function(){t.notifies=[]},t.notifies=[],{on:t.on,off:t.off,trigger:t.trigger,clearAll:t.clearAll}});